#!/bin/sh

export PATH=/opt/fluxbox/bin:$PATH

userresources=$HOME/.Xresources
usermodmap=$HOME/.Xmodmap
sysresources=/etc/X11/xinit/.Xresources
sysmodmap=/etc/X11/xinit/.Xmodmap

if [ -f $sysresources ]; then
    xrdb -merge $sysresources
fi

if [ -f $sysmodmap ]; then
    xmodmap $sysmodmap
fi

if [ -f "$userresources" ]; then
    xrdb -merge "$userresources"
fi

if [ -f "$usermodmap" ]; then
    xmodmap "$usermodmap"
fi

gnome-settings-daemon &
eval $(gnome-keyring-daemon --start)
export SSH_AUTH_SOCK

echo "export DISPLAY='$DISPLAY'"       >  ~/.x-env
echo "export XAUTHORITY='$XAUTHORITY'" >> ~/.x-env

exec ck-launch-session dbus-launch --autolaunch=444e9b7694df1a1f58655309536f0f3b --exit-with-session /opt/fluxbox/bin/startfluxbox
